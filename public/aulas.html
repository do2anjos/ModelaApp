<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Aula | Modela+</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700&family=Roboto:wght@400;500&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="/style.css">
</head>
<body class="lesson-body">

    <header class="lesson-header">
        <div class="container header-container">
            <div class="logo">
                <a href="#">
                    <img src="/Modela+p.png" alt="Logo da Modela+">
                </a>
            </div>
            <div class="user-profile-menu">
                <button class="user-avatar-button" id="user-menu-button" aria-label="Abrir menu do usuário">
                    MD
                </button>
                <div class="dropdown-menu hidden" id="user-dropdown">
                    <div class="dropdown-header">
                            <p class="user-name">Matheus dos Anjos </p>
                            <p class="user-email">mdap.lic20@uea.edu.br</p>
                        </div>
                        <ul>
                    <li><a href="#">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                        Meu Perfil
                    </a></li>
                    <li><a href="#">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12.22 2h-4.44a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.88z"/><path d="M18 2h-2.17a2 2 0 0 0-1.41.59L12 5l-2.41-2.41A2 2 0 0 0 8.17 2H6"/><path d="M9.5 2a2.83 2.83 0 0 1 5 0"/></svg>
                        Configurações
                    </a></li>
                    <li><a href="/login.html">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" x2="9" y1="12" y2="12"/></svg>
                        Sair
                    </a></li>
                    </ul>
                </div>
            </div>
        </div>
    </header>

    <div class="lesson-page-wrapper">
        <aside class="lesson-sidebar">
            <div class="sidebar-title-wrapper" style="display: flex; justify-content: space-between; align-items: center;">
            <h3>Tópicos do Curso</h3>
            <a href="/home.html" class="back-button" style="display: flex; align-items: center; gap: 4px; font-size: 0.85rem; text-decoration: none; color: inherit;">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="m15 18-6-6 6-6"/>
                </svg>
                <span>Voltar</span>
            </a>
            </div>

            <nav class="lesson-topics-nav">
                <details class="topic-accordion" open>
                    <summary>
    <span>Modelagem com UML</span>
    <span class="topic-progress">1/9</span>
                </summary>
                <ul class="lesson-list">
                    <li><a href="#" class="active" data-video-id="Ba50CH6ImBo"><span class="lesson-icon play"></span><span>Conceitos e História da UML</span><span class="lesson-duration">15:56</span></a></li>
                    <li><a href="#" data-video-id="rDidOn6KN9k"><span class="lesson-icon todo"></span><span>Relacionamentos: Associação e Agregação</span><span class="lesson-duration">11:13</span></a></li>
                    <li><a href="#" data-video-id="ab6eDdwS3rA"><span class="lesson-icon todo"></span><span>Diagrama de Casos de Uso</span><span class="lesson-duration">22:07</span></a></li>
                    <li><a href="#" data-video-id="rDidOn6KN9k"><span class="lesson-icon todo"></span><span>Diagrama de Classes</span><span class="lesson-duration">31:11</span></a></li>
                    <li><a href="#" data-video-id="qaWShGkUiBo"><span class="lesson-icon todo"></span><span>Diagrama de Sequência</span><span class="lesson-duration">27:00</span></a></li>
                    <li><a href="#" data-video-id="-d9bg1rZNhk"><span class="lesson-icon todo"></span><span>Diagrama de Atividades</span><span class="lesson-duration">16:51</span></a></li>
                    <li><a href="#" data-video-id="UVkj3ed0ZuM"><span class="lesson-icon todo"></span><span>Diagrama de Estados</span><span class="lesson-duration">12:35</span></a></li>
                    <li><a href="#" data-video-id="CWj2F9dfIaU"><span class="lesson-icon todo"></span><span>Diagrama de Componentes</span><span class="lesson-duration">07:53</span></a></li>
                    <li><a href="#" data-video-id="pCCqiJDLr4Y"><span class="lesson-icon todo"></span><span>Estudo de Caso Prático</span><span class="lesson-duration">47:45</span></a></li>
                </ul>
                </details>

                <details class="topic-accordion">
                <summary>
                    <span>Engenharia de Requisitos</span>
                    <span class="topic-progress">0/7</span>
                </summary>
                <ul class="lesson-list">
                    <li><a href="#" data-video-id="oF138gja4VI"><span class="lesson-icon todo"></span><span>Introdução à Engenharia de Requisitos</span><span class="lesson-duration">11:51</span></a></li>
                    <li><a href="#" data-video-id="7pSEvIog478"><span class="lesson-icon todo"></span><span>Requisitos Funcionais e Não-Funcionais</span><span class="lesson-duration">14:12</span></a></li>
                    <li><a href="#" data-video-id="4Wp-B7-b01U"><span class="lesson-icon todo"></span><span>Elicitação de Requisitos</span><span class="lesson-duration">12:15</span></a></li>
                    <li><a href="#" data-video-id="R_qSj2Y8-q4"><span class="lesson-icon todo"></span><span>Análise e Negociação de Requisitos</span><span class="lesson-duration">08:24</span></a></li>
                    <li><a href="#" data-video-id="8lAqA4-Q3wI"><span class="lesson-icon todo"></span><span>Validação e Verificação</span><span class="lesson-duration">06:29</span></a></li>
                    <li><a href="#" data-video-id="i9-yFp-F2qQ"><span class="lesson-icon todo"></span><span>Documentação de Requisitos</span><span class="lesson-duration">12:30</span></a></li>
                    <li><a href="#" data-video-id="wqpLHBz3R44"><span class="lesson-icon todo"></span><span>Rastreabilidade de Requisitos</span><span class="lesson-duration">09:56</span></a></li>
                </ul>
                </details>

                <details class="topic-accordion">
                <summary>
                    <span>Arquitetura de Sistemas</span>
                    <span class="topic-progress">0/6</span>
                </summary>
                <ul class="lesson-list">
                    <li><a href="#" data-video-id="A-wKEY8L_GA"><span class="lesson-icon todo"></span><span>Fundamentos da Arquitetura de Software</span><span class="lesson-duration">13:17</span></a></li>
                    <li><a href="#" data-video-id="TzY2w0F-BEA"><span class="lesson-icon todo"></span><span>Atributos de Qualidade Arquitetural</span><span class="lesson-duration">11:12</span></a></li>
                    <li><a href="#" data-video-id="Y1p_I2k-d4o"><span class="lesson-icon todo"></span><span>Padrões Arquiteturais (N-Tier, MVC)</span><span class="lesson-duration">09:07</span></a></li>
                    <li><a href="#" data-video-id="7iOU3_eLYQE"><span class="lesson-icon todo"></span><span>Arquitetura de Microsserviços</span><span class="lesson-duration">19:30</span></a></li>
                    <li><a href="#" data-video-id="j1II4A_z-Rk"><span class="lesson-icon todo"></span><span>Documentação com Visões 4+1</span><span class="lesson-duration">12:47</span></a></li>
                    <li><a href="#" data-video-id="kG2LEqaT-pc"><span class="lesson-icon todo"></span><span>Avaliação de Arquiteturas (ATAM)</span><span class="lesson-duration">05:46</span></a></li>
                </ul>
                </details>

                <details class="topic-accordion">
                <summary>
                    <span>Padrões de Projeto</span>
                    <span class="topic-progress">0/8</span>
                </summary>
                <ul class="lesson-list">
                    <li><a href="#" data-video-id="Y-dQ-A4a9-4"><span class="lesson-icon todo"></span><span>Introdução a Design Patterns</span><span class="lesson-duration">16:55</span></a></li>
                    <li><a href="#" data-video-id="Tz9-913P05A"><span class="lesson-icon todo"></span><span>Padrões Criacionais: Singleton</span><span class="lesson-duration">27:07</span></a></li>
                    <li><a href="#" data-video-id="WEcAlRet2k4"><span class="lesson-icon todo"></span><span>Padrões Criacionais: Factory Method</span><span class="lesson-duration">27:14</span></a></li>
                    <li><a href="#" data-video-id="SVLcVbxC-yU"><span class="lesson-icon todo"></span><span>Padrões Estruturais: Adapter</span><span class="lesson-duration">18:02</span></a></li>
                    <li><a href="#" data-video-id="EjP9a_w2060"><span class="lesson-icon todo"></span><span>Padrões Estruturais: Decorator</span><span class="lesson-duration">18:59</span></a></li>
                    <li><a href="#" data-video-id="iMKuf1n36-M"><span class="lesson-icon todo"></span><span>Padrões Comportamentais: Observer</span><span class="lesson-duration">20:25</span></a></li>
                    <li><a href="#" data-video-id="1zB-a-fBNvI"><span class="lesson-icon todo"></span><span>Padrões Comportamentais: Strategy</span><span class="lesson-duration">18:04</span></a></li>
                    <li><a href="#" data-video-id="4tDDa-gM-4A"><span class="lesson-icon todo"></span><span>Quando e como usar Padrões de Projeto</span><span class="lesson-duration">13:56</span></a></li>
                </ul>
                </details>

            </nav>
        </aside>

        <main class="lesson-main-content">
            <div class="player-header">
                <a href="#" class="back-button">
                    <span id="lesson-title-header">Conceitos e História da UML</span>
                </a>
                <div class="player-controls">
                    <a href="#" class="button button-primary" id="complete-lesson-btn">Marcar como concluído</a>
                    <a href="#" class="button button-secondary hidden" id="view-exercise-btn">Ver Exercício</a>
                </div>
            </div>

            <div class="video-player-wrapper">
                </div>
            
            <section class="lesson-reading-content">
                <h2>Conteúdo da Aula</h2>
                <h3 id="reading-title">Conceitos e História da UML</h3>
                <div id="reading-text">
                    <p>
                        A Linguagem de Modelagem Unificada (UML - Unified Modeling Language) é uma linguagem de modelagem visual de propósito geral no campo da engenharia de software, que se destina a fornecer uma maneira padrão de visualizar o design de um sistema.
                    </p>
                    <p>
                        Criada por Grady Booch, Ivar Jacobson e James Rumbaugh (os "Três Amigos") na Rational Software durante a década de 1990, a UML foi concebida para unificar as notações de modelagem orientada a objetos que existiam na época. A sua padronização pelo Object Management Group (OMG) em 1997 consolidou-a como a linguagem de modelagem padrão da indústria.
                    </p>
                </div>
                <div class="additional-resources">
                    <h4>Recursos Adicionais</h4>
                    <a href="#">Baixar material em PDF</a>
                    <a href="#">Link para documentação oficial</a>
                </div>
            </section>
        </main>
    </div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // --- SELETORES DO DOM ---
        const lessonLinks = document.querySelectorAll('.lesson-list a');
        const videoWrapper = document.querySelector('.video-player-wrapper');
        const lessonTitleHeader = document.getElementById('lesson-title-header');
        const completeButton = document.getElementById('complete-lesson-btn');
        const viewExerciseBtn = document.getElementById('view-exercise-btn');
        const readingTitle = document.getElementById('reading-title');
        const readingText = document.getElementById('reading-text');
        const accordions = document.querySelectorAll('.topic-accordion');

        // --- DADOS E ESTADO ---
        const lessonData = {
            "Conceitos e História da UML": {
                reading: "<p>A Linguagem de Modelagem Unificada (UML) é uma linguagem padrão para visualizar, especificar, construir e documentar os artefatos de um sistema de software. Criada nos anos 90, unificou diversas notações orientadas a objetos.</p>",
                exerciseUrl: "/exercicios/uml-conceitos.html"
            },
            "Relacionamentos: Associação e Agregação": {
                reading: "<p>Os relacionamentos em UML definem como as classes se conectam. Associação é uma relação estrutural básica, enquanto agregação é uma forma específica de associação que representa um relacionamento 'todo-parte'.</p>",
                exerciseUrl: "/exercicios/uml-relacionamentos.html"
            },
            "Diagrama de Casos de Uso": {
                reading: "<p>O diagrama de casos de uso captura os requisitos funcionais do sistema, mostrando as interações entre atores externos e os casos de uso que o sistema oferece.</p>",
                exerciseUrl: "/exercicios/uml-casos-uso.html"
            }
        };

        // Estado do usuário para cada aula
        const userProgress = JSON.parse(localStorage.getItem('userProgress')) || {};

        // --- FUNÇÕES ---

        // Carrega o conteúdo de uma aula específica
        function loadLesson(lessonLink) {
            // Desativa a aula anterior
            lessonLinks.forEach(link => {
                link.classList.remove('active');
                const icon = link.querySelector('.lesson-icon');
                if (icon.classList.contains('play')) {
                    icon.classList.remove('play');
                    if (!icon.classList.contains('completed')) icon.classList.add('todo');
                }
            });

            // Ativa a nova aula
            lessonLink.classList.add('active');
            const activeIcon = lessonLink.querySelector('.lesson-icon');
            if (!activeIcon.classList.contains('completed')) {
                activeIcon.classList.remove('todo');
                activeIcon.classList.add('play');
            }
            
            // Carrega o vídeo e o texto
            const videoId = lessonLink.getAttribute('data-video-id');
            const lessonTitle = lessonLink.querySelector('span:nth-of-type(2)').textContent;
            
            let embedUrl;
            if (videoId.startsWith("PL")) {
                embedUrl = `https://www.youtube.com/embed?listType=playlist&list=${videoId}&autoplay=1&rel=0&modestbranding=1`;
            } else {
                embedUrl = `https://www.youtube.com/embed/${videoId}?autoplay=1&rel=0&modestbranding=1`;
            }

            videoWrapper.innerHTML = `<iframe width="100%" height="100%" src="${embedUrl}" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>`;
            
            lessonTitleHeader.textContent = lessonTitle;
            readingTitle.textContent = lessonTitle;
            
            // Carrega material de leitura específico da aula
            const lessonInfo = lessonData[lessonTitle] || {};
            readingText.innerHTML = lessonInfo.reading || "<p>Nenhum material de leitura disponível para esta aula.</p>";

            // Atualiza estado dos botões
            updateCompleteButtonState(activeIcon);
            updateExerciseButtonState(lessonTitle);
        }

        // Atualiza o estado do botão "Marcar como concluído"
        function updateCompleteButtonState(activeIcon) {
            if (activeIcon.classList.contains('completed')) {
                completeButton.classList.remove('button-primary');
                completeButton.classList.add('completed');
                completeButton.textContent = '✅ Concluído';
            } else {
                completeButton.classList.remove('completed');
                completeButton.classList.add('button-primary');
                completeButton.textContent = 'Marcar como concluído';
            }
        }

        // Atualiza o estado do botão "Ver Exercício"
        function updateExerciseButtonState(lessonTitle) {
            const progress = userProgress[lessonTitle];
            
            if (progress && progress.completed && progress.exerciseCompleted) {
                // Aula e exercício concluídos
                viewExerciseBtn.classList.remove('button-secondary');
                viewExerciseBtn.classList.add('completed');
                viewExerciseBtn.textContent = '✅ Exercício Concluído';
                viewExerciseBtn.classList.remove('hidden');
            } else if (progress && progress.completed) {
                // Aula concluída, exercício disponível
                viewExerciseBtn.classList.remove('completed');
                viewExerciseBtn.classList.add('button-secondary');
                viewExerciseBtn.textContent = 'Ver Exercício';
                viewExerciseBtn.classList.remove('hidden');
            } else {
                // Aula não concluída, exercício bloqueado
                viewExerciseBtn.classList.add('hidden');
            }

            // Define a URL do exercício se disponível
            const lessonInfo = lessonData[lessonTitle];
            if (lessonInfo && lessonInfo.exerciseUrl) {
                viewExerciseBtn.href = lessonInfo.exerciseUrl;
            }
        }

        // Atualiza o contador de progresso de um tópico
        function updateTopicProgress(accordionElement) {
            const progressSpan = accordionElement.querySelector('.topic-progress');
            const lessons = accordionElement.querySelectorAll('.lesson-list li');
            const completedLessons = accordionElement.querySelectorAll('.lesson-icon.completed');
            
            progressSpan.textContent = `${completedLessons.length}/${lessons.length}`;
        }

        // Verifica se pode desbloquear próxima aula
        function unlockNextLesson(currentLessonTitle) {
            const currentLessonLink = document.querySelector(`.lesson-list a.active`);
            const currentListItem = currentLessonLink.parentElement;
            const nextListItem = currentListItem.nextElementSibling;
            
            if (nextListItem) {
                const nextLessonLink = nextListItem.querySelector('a');
                const nextLessonTitle = nextLessonLink.querySelector('span:nth-of-type(2)').textContent;
                
                // Desbloqueia próxima aula se a atual foi concluída
                if (userProgress[currentLessonTitle] && userProgress[currentLessonTitle].completed) {
                    const nextIcon = nextLessonLink.querySelector('.lesson-icon');
                    if (nextIcon.classList.contains('locked')) {
                        nextIcon.classList.remove('locked');
                        nextIcon.classList.add('todo');
                    }
                }
            }
        }

        // --- EVENT LISTENERS ---

        // Carrega a primeira aula ao entrar na página
        const firstLesson = document.querySelector('.lesson-list a.active');
        if (firstLesson) loadLesson(firstLesson);

        // Adiciona evento de clique para cada link de aula
        lessonLinks.forEach(link => {
            link.addEventListener('click', function(event) {
                event.preventDefault();
                
                // Verifica se a aula está bloqueada
                const icon = this.querySelector('.lesson-icon');
                if (icon.classList.contains('locked')) {
                    alert('Complete a aula anterior para desbloquear esta aula.');
                    return;
                }
                
                loadLesson(this);
            });
        });

        // Evento de clique no botão de completar aula
        completeButton.addEventListener('click', function(event) {
            event.preventDefault();
            const activeLessonLink = document.querySelector('.lesson-list a.active');
            if (!activeLessonLink) return;

            const activeIcon = activeLessonLink.querySelector('.lesson-icon');
            const lessonTitle = activeLessonLink.querySelector('span:nth-of-type(2)').textContent;
            
            // Alterna estado de conclusão
            const isNowCompleted = !activeIcon.classList.contains('completed');
            activeIcon.classList.toggle('completed');

            // Atualiza estado no localStorage
            if (!userProgress[lessonTitle]) {
                userProgress[lessonTitle] = {};
            }
            userProgress[lessonTitle].completed = isNowCompleted;
            localStorage.setItem('userProgress', JSON.stringify(userProgress));

            // Alterna entre os estados 'play' e 'todo' se não estiver completo
            if (activeIcon.classList.contains('completed')) {
                activeIcon.classList.remove('play');
            } else {
                activeIcon.classList.add('play');
            }
            
            updateCompleteButtonState(activeIcon);
            updateExerciseButtonState(lessonTitle);
            
            // Atualiza o contador do tópico atual
            const parentAccordion = activeLessonLink.closest('.topic-accordion');
            updateTopicProgress(parentAccordion);
            
            // Desbloqueia próxima aula se concluída
            if (isNowCompleted) {
                unlockNextLesson(lessonTitle);
            }
        });

        // Evento de clique no botão de exercício
        viewExerciseBtn.addEventListener('click', function(event) {
            const activeLessonLink = document.querySelector('.lesson-list a.active');
            if (!activeLessonLink) return;
            
            const lessonTitle = activeLessonLink.querySelector('span:nth-of-type(2)').textContent;
            const progress = userProgress[lessonTitle];
            
            // Verifica se a aula foi concluída
            if (!progress || !progress.completed) {
                event.preventDefault();
                alert('Você precisa completar a aula antes de acessar o exercício.');
                return;
            }
        });

        // Lógica para o accordion "sanfona"
        accordions.forEach(accordion => {
            accordion.addEventListener('toggle', function() {
                // Se o accordion atual foi aberto, fecha os outros
                if (this.open) {
                    accordions.forEach(otherAccordion => {
                        if (otherAccordion !== this) {
                            otherAccordion.open = false;
                        }
                    });
                }
            });
        });

        // Lógica do menu dropdown do usuário
        const userMenuButton = document.getElementById('user-menu-button');
        const userDropdown = document.getElementById('user-dropdown');

        if (userMenuButton && userDropdown) {
            userMenuButton.addEventListener('click', (event) => {
                event.stopPropagation();
                userDropdown.classList.toggle('hidden');
            });
            window.addEventListener('click', () => {
                userDropdown.classList.add('hidden');
            });
            userDropdown.addEventListener('click', (event) => event.stopPropagation());
        }

        // Inicialização: bloqueia aulas não iniciadas e carrega progresso
        function initializeProgress() {
            lessonLinks.forEach((link, index) => {
                const lessonTitle = link.querySelector('span:nth-of-type(2)').textContent;
                const icon = link.querySelector('.lesson-icon');
                
                // Carrega estado salvo
                if (userProgress[lessonTitle] && userProgress[lessonTitle].completed) {
                    icon.classList.remove('todo', 'play');
                    icon.classList.add('completed');
                } else if (index > 0) {
                    // Bloqueia aulas além da primeira
                    const prevLessonTitle = lessonLinks[index - 1].querySelector('span:nth-of-type(2)').textContent;
                    if (!userProgress[prevLessonTitle] || !userProgress[prevLessonTitle].completed) {
                        icon.classList.remove('todo');
                        icon.classList.add('locked');
                    }
                }
            });

            // Atualiza contadores de progresso
            accordions.forEach(accordion => {
                updateTopicProgress(accordion);
            });
        }

        initializeProgress();
    });
</script>
</body>
</html> 