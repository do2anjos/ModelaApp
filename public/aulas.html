<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Aula | Modela+</title>
    <script>
        // Inicializa√ß√£o precoce - definir tema antes do carregamento
        (function() {
            try {
                var theme = localStorage.getItem('theme') || 'system';
                if (['dark','light'].includes(theme)) {
                    document.documentElement.setAttribute('data-theme', theme);
                } else if(window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    document.documentElement.setAttribute('data-theme', 'dark');
                } else {
                    document.documentElement.setAttribute('data-theme', 'light');
                }
                console.log('üé® Theme set early:', document.documentElement.getAttribute('data-theme'));
            } catch(e){
                console.error('‚ùå Early theme init error:', e);
            }
        })();
    </script>

    <script>
        (function() {
            try {
                var daltonism = localStorage.getItem('daltonism') || 'nenhum';
                console.log('üé® Daltonism mode:', daltonism);
                if (daltonism && daltonism !== 'nenhum') {
                    document.documentElement.setAttribute('data-daltonismo', daltonism);
                    console.log('‚úÖ Daltonism activated:', daltonism);
                } else {
                    document.documentElement.removeAttribute('data-daltonismo');
                    console.log('‚ùå Daltonism deactivated');
                }
            } catch(e){
                console.error('‚ùå Daltonism script error:', e);
            }
        })();
    </script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700&family=Roboto:wght@400;500&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="/style.css">
    <style>
        /* Filtros de daltonismo aplicados imediatamente (alinhados com style.css) */
        html[data-daltonismo="protanopia"] {
            filter: contrast(1.3) saturate(0.8) brightness(1.1) sepia(0.2);
        }
        html[data-daltonismo="deuteranopia"] {
            filter: contrast(1.25) saturate(1.1) brightness(0.95) hue-rotate(-15deg);
        }
        html[data-daltonismo="tritanopia"] {
            filter: contrast(1.2) saturate(0.9) brightness(1.05) hue-rotate(30deg);
        }

        /* CORRE√á√ÉO PROFUNDA: Isola a logo dos filtros globais para prevenir invers√£o de cor */
        html[data-daltonismo] .logo img,
        .logo img,
        #main-logo,
        .lesson-header .logo img {
            filter: none !important;
            -webkit-filter: none !important; /* Compatibilidade com Safari */
            transform: none !important;
            opacity: 1 !important;
            visibility: visible !important;
        }

        /* Prote√ß√£o absoluta contra qualquer filtro */
        .logo img::before,
        .logo img::after {
            display: none !important;
        }

        /* Manter tamanho de fonte original do t√≠tulo da aula */
        .player-header h1,
        #lesson-title-header {
            font-size: 1.5rem !important;
            margin: 0.5rem 0 0 0 !important;
            padding: 0 !important; /* Alinha com o breadcrumb */
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            color: var(--foreground) !important;
            line-height: 1.2 !important;
            position: relative !important;
            z-index: 1 !important;
        }
        
        /* Garantir que o container do h1 tamb√©m seja vis√≠vel */
        .player-header .header-main-content {
            display: block !important;
            width: 100% !important;
        }
    </style>
</head>
<body class="lesson-body">
    <a href="#main-content" class="skip-link">Pular para o conte√∫do principal</a>

    <header class="lesson-header">
        <div class="container header-container">
            <div class="logo">
                <a href="#">
                    <img src="/Modela+p.png" alt="Logo da Modela+" id="main-logo">
                </a>
            </div>
            <div class="user-profile-menu">
                <div id="user-gamification" class="user-gamification"></div>
                <button class="user-avatar-button" id="user-menu-button" aria-label="Abrir menu do usu√°rio">
                    MD
                </button>
                <div class="dropdown-menu hidden" id="user-dropdown">
                    <div class="dropdown-header">
                            <p class="user-name">Matheus dos Anjos </p>
                            <p class="user-email">mdap.lic20@uea.edu.br</p>
                        </div>
                        <ul>
                    <li><a href="/perfil.html"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg> Meu Perfil</a></li>
                    <li><a href="/configuracoes.html">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
                        Configura√ß√µes
                    </a></li>
                    <li><a href="/login.html">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" x2="9" y1="12" y2="12"/></svg>
                        Sair
                    </a></li>
                    </ul>
                </div>
            </div>
        </div>
    </header>

    <div class="lesson-page-wrapper">
        <aside class="lesson-sidebar">
            <div class="sidebar-title-wrapper">
            <h3>T√≥picos do Curso</h3>
            <a href="/home.html" class="sidebar-back-button">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="m15 18-6-6 6-6"/>
                </svg>
                <span>Voltar</span>
            </a>
            </div>

            <nav class="lesson-topics-nav">
                <details class="topic-accordion">
                    <summary>
    <span>Modelagem com UML</span>
    <span class="topic-progress">1/9</span>
                </summary>
                <ul class="lesson-list">
                    <li><a href="#" class="active" data-video-id="d4j02XdB77g"><span class="lesson-icon play"></span><span>Conceitos e Hist√≥ria da UML</span><span class="lesson-duration">15:56</span></a></li>
                    <li class="lesson-locked"><a href="#" data-video-id="rDidOn6KN9k">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
                        <span>Relacionamentos: Associa√ß√£o e Agrega√ß√£o</span><span class="lesson-duration">11:13</span></a></li>
                    <li class="lesson-locked"><a href="#" data-video-id="ab6eDdwS3rA">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
                        <span>Diagrama de Casos de Uso</span><span class="lesson-duration">22:07</span></a></li>
                    <li class="lesson-locked"><a href="#" data-video-id="rDidOn6KN9k">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
                        <span>Diagrama de Classes</span><span class="lesson-duration">31:11</span></a></li>
                    <li class="lesson-locked"><a href="#" data-video-id="qaWShGkUiBo">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
                        <span>Diagrama de Sequ√™ncia</span><span class="lesson-duration">27:00</span></a></li>
                    <li class="lesson-locked"><a href="#" data-video-id="-d9bg1rZNhk">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
                        <span>Diagrama de Atividades</span><span class="lesson-duration">16:51</span></a></li>
                    <li class="lesson-locked"><a href="#" data-video-id="UVkj3ed0ZuM">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
                        <span>Diagrama de Estados</span><span class="lesson-duration">12:35</span></a></li>
                    <li class="lesson-locked"><a href="#" data-video-id="CWj2F9dfIaU">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
                        <span>Diagrama de Componentes</span><span class="lesson-duration">07:53</span></a></li>
                    <li class="lesson-locked"><a href="#" data-video-id="pCCqiJDLr4Y">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
                        <span>Estudo de Caso Pr√°tico</span><span class="lesson-duration">47:45</span></a></li>
                </ul>
                </details>

                <details class="topic-accordion locked-topic">
                <summary>
                    <span>Engenharia de Requisitos</span>
                    <span class="topic-progress">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
                    </span>
                </summary>
                <div class="locked-content">
                    <p>Este t√≥pico ser√° desbloqueado ap√≥s a conclus√£o de "Modelagem com UML".</p>
                </div>
                </details>

                <details class="topic-accordion locked-topic">
                <summary>
                    <span>Arquitetura de Sistemas</span>
                    <span class="topic-progress">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
                    </span>
                </summary>
                <div class="locked-content">
                    <p>Este t√≥pico ser√° desbloqueado ap√≥s a conclus√£o de "Modelagem com UML".</p>
                </div>
                </details>

                <details class="topic-accordion locked-topic">
                <summary>
                    <span>Padr√µes de Projeto</span>
                    <span class="topic-progress">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
                    </span>
                </summary>
                <div class="locked-content">
                    <p>Este t√≥pico ser√° desbloqueado ap√≥s a conclus√£o de "Modelagem com UML".</p>
                </div>
                </details>

            </nav>
        </aside>

        <main class="lesson-main-content" id="main-content">
            <div class="player-header">
                <div class="header-main-content">
                    <nav class="breadcrumb" aria-label="Navega√ß√£o estrutural">
                        <ol>
                            <li><a href="/">In√≠cio</a></li>
                            <li><a href="/home.html">Painel</a></li>
                            <li aria-current="page">Aulas</li>
                        </ol>
                    </nav>
                    
                    <h1 id="lesson-title-header">Conceitos e Hist√≥ria da UML</h1>
                </div>
                <div class="header-actions">    
                
                <div class="player-controls" role="toolbar" aria-label="Controles da aula">
                    <button class="button button-secondary hidden" id="view-exercise-btn" aria-label="Ver exerc√≠cio da aula">Ver Exerc√≠cio</button>
                    <button class="button button-primary hidden" id="complete-lesson-btn" aria-label="Marcar aula como conclu√≠da">Marcar como conclu√≠do</button>
                    <button class="button button-primary hidden" id="next-lesson-btn" aria-label="Ir para pr√≥xima aula">Pr√≥xima Aula</button>
                </div>
                </div>
            </div>

            <div class="video-player-wrapper">
            </div>
            
            <section class="lesson-reading-content">
                <h2>Conte√∫do da Aula</h2>
                <h3 id="reading-title">Conceitos e Hist√≥ria da UML</h3>
                <div id="reading-text">
                    <p>
                        A Linguagem de Modelagem Unificada (UML - Unified Modeling Language) √© uma linguagem de modelagem visual de prop√≥sito geral no campo da engenharia de software, que se destina a fornecer uma maneira padr√£o de visualizar o design de um sistema.
                    </p>
                    <p>
                        Criada por Grady Booch, Ivar Jacobson e James Rumbaugh (os "Tr√™s Amigos") na Rational Software durante a d√©cada de 1990, a UML foi concebida para unificar as nota√ß√µes de modelagem orientada a objetos que existiam na √©poca. A sua padroniza√ß√£o pelo Object Management Group (OMG) em 1997 consolidou-a como a linguagem de modelagem padr√£o da ind√∫stria.
                    </p>
                </div>
                <div class="additional-resources">
                    <h4>Recursos Adicionais</h4>
                    <a href="#">Baixar material em PDF</a>
                    <a href="#">Link para documenta√ß√£o oficial</a>
                </div>
            </section>

            <section class="lesson-exercise-content" id="exercise-section" aria-labelledby="exercise-title">
                <h2 id="exercise-title">Exerc√≠cio</h2>
                <p class="exercise-description">Teste seus conhecimentos sobre o conte√∫do da aula respondendo √†s quest√µes abaixo.</p>
                <form id="exercise-form" aria-label="Formul√°rio de exerc√≠cio">
                    <fieldset class="exercise-question">
                        <legend>1. O que significa a sigla UML?</legend>
                        <div class="radio-group">
                            <label><input type="radio" name="q1" value="a" required> a) Unified Modeling Language</label>
                            <label><input type="radio" name="q1" value="b" required> b) Universal Modeling Language</label>
                            <label><input type="radio" name="q1" value="c" required> c) Unique Modeling Language</label>
                        </div>
                    </fieldset>
                    <fieldset class="exercise-question">
                        <legend>2. Quais s√£o os tr√™s autores principais da UML?</legend>
                        <div class="radio-group">
                            <label><input type="radio" name="q2" value="a" required> a) Grady Booch, Ivar Jacobson, James Rumbaugh</label>
                            <label><input type="radio" name="q2" value="b" required> b) Martin Fowler, Kent Beck, Erich Gamma</label>
                            <label><input type="radio" name="q2" value="c" required> c) Alan Turing, John von Neumann, Alonzo Church</label>
                        </div>
                    </fieldset>
                    <fieldset class="exercise-question">
                        <legend>3. Qual organiza√ß√£o padronizou a UML?</legend>
                        <div class="radio-group">
                            <label><input type="radio" name="q3" value="a" required> a) Object Management Group (OMG)</label>
                            <label><input type="radio" name="q3" value="b" required> b) World Wide Web Consortium (W3C)</label>
                            <label><input type="radio" name="q3" value="c" required> c) International Organization for Standardization (ISO)</label>
                        </div>
                    </fieldset>
                    <div class="exercise-actions">
                        <button type="button" id="submit-exercise" class="button button-primary">Verificar Respostas</button>
                    </div>
                </form>
                <div id="exercise-feedback" role="region" aria-live="polite" aria-label="Resultado do exerc√≠cio"></div>
            </section>
        </main>
    </div>

<!-- Scripts para gerenciar dark mode, daltonism mode e usabilidade -->
<script src="/dark-mode.js"></script>
<script src="/daltonism-mode.js"></script>
<script src="/usability.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // --- INICIALIZA√á√ÉO DA LOGO ---
        // Aulas.html sempre usa logo branca (Modela+p.png) nativamente
        (function() {
            try {
                var logoSrc = '/Modela+p.png'; // Sempre branca para aulas.html
                console.log('üé® Aulas.html - Using white logo natively:', logoSrc);

                // Aplicar logo branca imediatamente
                var logos = document.querySelectorAll('img[src*="Modela"]');
                console.log('üîç Found logos:', logos.length);
                logos.forEach(function(logo, index) {
                    console.log(`üì∏ Logo ${index}:`, logo.src, '‚Üí', logoSrc);
                    console.log(`üîß Logo ${index} computed style:`, window.getComputedStyle(logo).filter);
                    // For√ßa sempre a logo branca
                    if (logo.src.includes('Modela+a.png') || logo.src.includes('Modela+p.png')) {
                        logo.src = logoSrc;
                    }
                });
            } catch(e){
                console.error('‚ùå Logo init error:', e);
            }
        })();

        // --- SELETORES DO DOM ---
        const lessonLinks = document.querySelectorAll('.lesson-list a');
        const videoWrapper = document.querySelector('.video-player-wrapper');
        const lessonTitleHeader = document.getElementById('lesson-title-header');
        const completeButton = document.getElementById('complete-lesson-btn');
        const viewExerciseBtn = document.getElementById('view-exercise-btn');
        const nextLessonBtn = document.getElementById('next-lesson-btn');
        const readingTitle = document.getElementById('reading-title');
        const readingText = document.getElementById('reading-text');
        const accordions = document.querySelectorAll('.topic-accordion');
        const exerciseSection = document.getElementById('exercise-section');
        const submitExerciseBtn = document.getElementById('submit-exercise');
        const exerciseFeedback = document.getElementById('exercise-feedback');
        const exerciseForm = document.getElementById('exercise-form');

        // --- SISTEMA DE GAMIFICA√á√ÉO ---
        let userStats = {
            level: 'Iniciante',
            xp: 0,
            totalLessons: 0,
            badges: []
        };

        // Carrega estat√≠sticas do usu√°rio
        function loadUserStats() {
            const saved = localStorage.getItem('modelaUserStats');
            if (saved) {
                userStats = JSON.parse(saved);
            }
            updateGamificationDisplay();
        }

        // Salva estat√≠sticas do usu√°rio
        function saveUserStats() {
            localStorage.setItem('modelaUserStats', JSON.stringify(userStats));
        }

        // Atualiza XP do usu√°rio
        function updateUserXP(xpGained) {
            if (xpGained > 0) {
                userStats.xp += xpGained;
                updateUserLevel();
                updateGamificationDisplay();
                saveUserStats();
                showXPNotification(xpGained);
            }
        }

        // Atualiza n√≠vel do usu√°rio
        function updateUserLevel() {
            const oldLevel = userStats.level;
            if (userStats.xp >= 2000) userStats.level = 'Expert';
            else if (userStats.xp >= 1000) userStats.level = 'Avan√ßado';
            else if (userStats.xp >= 500) userStats.level = 'Intermedi√°rio';
            else userStats.level = 'Iniciante';
            
            if (oldLevel !== userStats.level) {
                showLevelUpNotification(oldLevel, userStats.level);
            }
        }

        // Auto-conclus√£o da aula
        function autoCompleteLesson(lessonTitle) {
            const activeLessonLink = document.querySelector('.lesson-list a.active');
            if (!activeLessonLink) return;

            const activeIcon = activeLessonLink.querySelector('.lesson-icon');
            
            // Marca a aula como conclu√≠da
            activeIcon.classList.remove('play', 'todo', 'video-watched');
            activeIcon.classList.add('completed');

            // Atualiza estado
            if (!userProgress[lessonTitle]) {
                userProgress[lessonTitle] = {};
            }
            userProgress[lessonTitle].completed = true;
            userProgress[lessonTitle].completedAt = new Date().toISOString();

            // Atualiza estat√≠sticas
            userStats.totalLessons++;
            saveUserStats();

            // Mostra bot√£o pr√≥xima aula
            showNextLessonButton();
            
            // Atualiza o contador do t√≥pico atual
            const parentAccordion = activeLessonLink.closest('.topic-accordion');
            updateTopicProgress(parentAccordion);
            
            // Desbloqueia pr√≥xima aula
            unlockNextLesson(lessonTitle);
        }

        // Mostra notifica√ß√£o de XP
        function showXPNotification(xpGained) {
            const notification = document.createElement('div');
            notification.className = 'xp-notification';
            notification.innerHTML = `
                <div class="xp-content">
                    <span class="xp-icon">‚≠ê</span>
                    <span class="xp-text">+${xpGained} XP</span>
                </div>
            `;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 3000);
        }

        // Mostra notifica√ß√£o de level up
        function showLevelUpNotification(oldLevel, newLevel) {
            const notification = document.createElement('div');
            notification.className = 'levelup-notification';
            notification.innerHTML = `
                <div class="levelup-content">
                    <span class="levelup-icon">üéâ</span>
                    <div class="levelup-text">
                        <div class="levelup-title">Level Up!</div>
                        <div class="levelup-subtitle">${oldLevel} ‚Üí ${newLevel}</div>
                    </div>
                </div>
            `;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 5000);
        }

        // --- DADOS E ESTADO ---
        const lessonData = {
            "Conceitos e Hist√≥ria da UML": {
                reading: "<p>A Linguagem de Modelagem Unificada (UML) √© uma linguagem padr√£o para visualizar, especificar, construir e documentar os artefatos de um sistema de software. Criada nos anos 90, unificou diversas nota√ß√µes orientadas a objetos.</p>",
                exerciseUrl: "/exercicios/uml-conceitos.html",
                correctAnswers: {
                    q1: "a",
                    q2: "a",
                    q3: "a",
                    q4: "c",
                    q5: "b"
                },
                explanations: {
                    q1: {
                        correct: "A sigla UML significa Unified Modeling Language (Linguagem de Modelagem Unificada).",
                        incorrect: {
                            a: "",
                            b: "Universal Modeling Language n√£o √© o significado correto da sigla UML.",
                            c: "Unique Modeling Language n√£o √© o significado correto da sigla UML."
                        }
                    },
                    q2: {
                        correct: "Os tr√™s autores principais s√£o Grady Booch, Ivar Jacobson e James Rumbaugh, conhecidos como os 'Tr√™s Amigos'.",
                        incorrect: {
                            a: "",
                            b: "Martin Fowler, Kent Beck e Erich Gamma s√£o importantes na engenharia de software, mas n√£o s√£o os criadores da UML.",
                            c: "Alan Turing, John von Neumann e Alonzo Church s√£o pioneiros da computa√ß√£o, mas n√£o criaram a UML."
                        }
                    },
                    q3: {
                        correct: "A UML foi padronizada pelo Object Management Group (OMG) em 1997.",
                        incorrect: {
                            a: "",
                            b: "O W3C padroniza tecnologias web, n√£o a UML.",
                            c: "A ISO padroniza normas internacionais, mas n√£o foi a respons√°vel pela padroniza√ß√£o inicial da UML."
                        }
                    },
                    q4: {
                        correct: "A UML 2.x possui 14 tipos de diagramas divididos em estruturais (7) e comportamentais (7).",
                        incorrect: {
                            a: "Esta √© uma informa√ß√£o incorreta sobre a UML.",
                            b: "Esta √© uma informa√ß√£o incorreta sobre a UML.",
                            c: "",
                            d: "Esta √© uma informa√ß√£o incorreta sobre a UML."
                        }
                    },
                    q5: {
                        correct: "A UML unificou as melhores pr√°ticas das tr√™s metodologias mais populares da √©poca, criando um padr√£o √∫nico e abrangente.",
                        incorrect: {
                            a: "Esta √© uma an√°lise incorreta do impacto da UML.",
                            b: "",
                            c: "Esta √© uma an√°lise incorreta do impacto da UML.",
                            d: "Esta √© uma an√°lise incorreta do impacto da UML."
                        }
                    }
                }
            },
            "Relacionamentos: Associa√ß√£o e Agrega√ß√£o": {
                reading: "<p>Os relacionamentos em UML definen como as classes se conectam. Associa√ß√£o √© uma rela√ß√£o estrutural b√°sica, enquanto agrega√ß√£o √© uma forma espec√≠fica de associa√ß√£o que representa um relacionamento 'todo-parte'.</p>",
                exerciseUrl: "/exercicios/uml-relacionamentos.html",
                correctAnswers: {
                    q1: "a",
                    q2: "b",
                    q3: "c",
                    q4: "a",
                    q5: "b"
                },
                explanations: {
                    q1: {
                        correct: "A associa√ß√£o √© o relacionamento mais b√°sico em UML.",
                        incorrect: {
                            a: "",
                            b: "Esta n√£o √© a defini√ß√£o correta de associa√ß√£o.",
                            c: "Esta √© uma defini√ß√£o incorreta de associa√ß√£o."
                        }
                    },
                    q2: {
                        correct: "A agrega√ß√£o representa um relacionamento todo-parte.",
                        incorrect: {
                            a: "Esta √© a defini√ß√£o de associa√ß√£o, n√£o de agrega√ß√£o.",
                            b: "",
                            c: "Esta √© a defini√ß√£o de composi√ß√£o, n√£o de agrega√ß√£o."
                        }
                    },
                    q3: {
                        correct: "Na agrega√ß√£o, as partes podem existir independentemente do todo.",
                        incorrect: {
                            a: "Esta caracter√≠stica pertence √† composi√ß√£o.",
                            b: "Esta √© uma caracter√≠stica da associa√ß√£o.",
                            c: ""
                        }
                    },
                    q4: {
                        correct: "A multiplicidade 1..* indica que pode haver um ou muitos elementos no relacionamento.",
                        incorrect: {
                            a: "",
                            b: "0..* indica zero ou muitos elementos.",
                            c: "1..1 indica exatamente um elemento.",
                            d: "* indica zero ou muitos elementos."
                        }
                    },
                    q5: {
                        correct: "A composi√ß√£o representa um relacionamento mais forte que a agrega√ß√£o, onde as partes n√£o podem existir sem o todo.",
                        incorrect: {
                            a: "Esta √© uma caracter√≠stica da agrega√ß√£o, n√£o da composi√ß√£o.",
                            b: "",
                            c: "Esta √© uma caracter√≠stica da associa√ß√£o, n√£o da composi√ß√£o.",
                            d: "Esta √© uma caracter√≠stica da heran√ßa, n√£o da composi√ß√£o."
                        }
                    }
                }
            },
            "Diagrama de Casos de Uso": {
                reading: "<p>O diagrama de casos de uso captura os requisitos funcionais do sistema, mostrando as intera√ß√µes entre atores externos e os casos de uso que o sistema oferece.</p>",
                exerciseUrl: "/exercicios/uml-casos-uso.html",
                correctAnswers: {
                    q1: "b",
                    q2: "a",
                    q3: "c",
                    q4: "b",
                    q5: "a"
                },
                explanations: {
                    q1: {
                        correct: "Os atores representam entidades externas que interagem com o sistema.",
                        incorrect: {
                            a: "Esta √© a defini√ß√£o de casos de uso, n√£o de atores.",
                            b: "",
                            c: "Esta √© a defini√ß√£o de relacionamentos, n√£o de atores."
                        }
                    },
                    q2: {
                        correct: "O relacionamento 'include' indica que um caso de uso sempre inclui o comportamento de outro.",
                        incorrect: {
                            a: "",
                            b: "Esta √© a defini√ß√£o do relacionamento 'extend'.",
                            c: "Esta √© a defini√ß√£o da generaliza√ß√£o."
                        }
                    },
                    q3: {
                        correct: "O relacionamento 'extend' indica comportamento opcional que pode ser adicionado.",
                        incorrect: {
                            a: "Esta √© a defini√ß√£o do relacionamento 'include'.",
                            b: "Esta √© a defini√ß√£o da generaliza√ß√£o.",
                            c: ""
                        }
                    },
                    q4: {
                        correct: "O ator pode ser tanto um usu√°rio humano quanto um sistema externo que interage com o sistema sendo modelado.",
                        incorrect: {
                            a: "Esta √© uma limita√ß√£o incorreta dos atores em UML.",
                            b: "",
                            c: "Esta √© uma defini√ß√£o incorreta de atores.",
                            d: "Esta √© uma defini√ß√£o incorreta de atores."
                        }
                    },
                    q5: {
                        correct: "Um caso de uso complexo com m√∫ltiplos atores deve mostrar claramente as intera√ß√µes entre todos os atores envolvidos.",
                        incorrect: {
                            a: "",
                            b: "Esta √© uma abordagem incorreta para casos de uso complexos.",
                            c: "Esta √© uma abordagem incorreta para casos de uso complexos.",
                            d: "Esta √© uma abordagem incorreta para casos de uso complexos."
                        }
                    }
                }
            },
            "Diagrama de Classes": {
                reading: "<p>O diagrama de classes √© o mais importante da UML, mostrando a estrutura est√°tica do sistema atrav√©s de classes, seus atributos, m√©todos e relacionamentos.</p>",
                exerciseUrl: "/exercicios/uml-classes.html",
                correctAnswers: {
                    q1: "c",
                    q2: "a",
                    q3: "b",
                    q4: "d",
                    q5: "c"
                },
                explanations: {
                    q1: {
                        correct: "A visibilidade privada (-) indica que o atributo s√≥ pode ser acessado dentro da pr√≥pria classe.",
                        incorrect: {
                            a: "Esta √© a visibilidade p√∫blica (+).",
                            b: "Esta √© a visibilidade protegida (#).",
                            c: "",
                            d: "Esta √© a visibilidade de pacote (~)."
                        }
                    },
                    q2: {
                        correct: "A heran√ßa representa um relacionamento '√© um tipo de', onde uma classe especializada herda caracter√≠sticas de uma classe mais geral.",
                        incorrect: {
                            a: "",
                            b: "Esta √© a defini√ß√£o de agrega√ß√£o.",
                            c: "Esta √© a defini√ß√£o de composi√ß√£o.",
                            d: "Esta √© a defini√ß√£o de associa√ß√£o."
                        }
                    },
                    q3: {
                        correct: "O polimorfismo permite que m√©todos com mesmo nome tenham implementa√ß√µes diferentes em classes relacionadas por heran√ßa.",
                        incorrect: {
                            a: "Esta √© a defini√ß√£o de encapsulamento.",
                            b: "",
                            c: "Esta √© a defini√ß√£o de abstra√ß√£o.",
                            d: "Esta √© a defini√ß√£o de heran√ßa."
                        }
                    },
                    q4: {
                        correct: "A multiplicidade 0..1 indica que pode haver zero ou um objeto no relacionamento.",
                        incorrect: {
                            a: "Esta √© a multiplicidade 1..1.",
                            b: "Esta √© a multiplicidade 1..*.",
                            c: "Esta √© a multiplicidade *.",
                            d: ""
                        }
                    },
                    q5: {
                        correct: "Uma classe abstrata n√£o pode ser instanciada diretamente e serve como base para outras classes.",
                        incorrect: {
                            a: "Esta √© a defini√ß√£o de interface.",
                            b: "Esta √© a defini√ß√£o de classe concreta.",
                            c: "",
                            d: "Esta √© a defini√ß√£o de classe final."
                        }
                    }
                }
            },
            "Diagrama de Sequ√™ncia": {
                reading: "<p>O diagrama de sequ√™ncia mostra as intera√ß√µes entre objetos ao longo do tempo, detalhando como mensagens s√£o trocadas entre eles.</p>",
                exerciseUrl: "/exercicios/uml-sequencia.html",
                correctAnswers: {
                    q1: "b",
                    q2: "c",
                    q3: "a",
                    q4: "d",
                    q5: "b"
                },
                explanations: {
                    q1: {
                        correct: "A linha de vida representa a exist√™ncia de um objeto durante a intera√ß√£o.",
                        incorrect: {
                            a: "Esta √© a defini√ß√£o de mensagem.",
                            b: "",
                            c: "Esta √© a defini√ß√£o de ativa√ß√£o.",
                            d: "Esta √© a defini√ß√£o de fragmento."
                        }
                    },
                    q2: {
                        correct: "A seta com linha s√≥lida representa uma mensagem s√≠ncrona, onde o remetente aguarda resposta.",
                        incorrect: {
                            a: "Esta √© a seta para mensagem ass√≠ncrona.",
                            b: "Esta √© a seta para mensagem de retorno.",
                            c: "",
                            d: "Esta √© a seta para mensagem de cria√ß√£o."
                        }
                    },
                    q3: {
                        correct: "A caixa de ativa√ß√£o mostra quando um objeto est√° executando uma opera√ß√£o.",
                        incorrect: {
                            a: "",
                            b: "Esta √© a defini√ß√£o de linha de vida.",
                            c: "Esta √© a defini√ß√£o de mensagem.",
                            d: "Esta √© a defini√ß√£o de fragmento."
                        }
                    },
                    q4: {
                        correct: "O fragmento 'alt' representa uma escolha condicional entre diferentes cen√°rios.",
                        incorrect: {
                            a: "Este √© o fragmento 'loop'.",
                            b: "Este √© o fragmento 'opt'.",
                            c: "Este √© o fragmento 'par'.",
                            d: ""
                        }
                    },
                    q5: {
                        correct: "A mensagem ass√≠ncrona permite que o remetente continue executando sem aguardar resposta.",
                        incorrect: {
                            a: "Esta √© a caracter√≠stica da mensagem s√≠ncrona.",
                            b: "",
                            c: "Esta √© a caracter√≠stica da mensagem de retorno.",
                            d: "Esta √© a caracter√≠stica da mensagem de cria√ß√£o."
                        }
                    }
                }
            },
            "Diagrama de Atividades": {
                reading: "<p>O diagrama de atividades modela fluxos de trabalho e processos, mostrando a sequ√™ncia de atividades e decis√µes.</p>",
                exerciseUrl: "/exercicios/uml-atividades.html",
                correctAnswers: {
                    q1: "a",
                    q2: "c",
                    q3: "b",
                    q4: "d",
                    q5: "a"
                },
                explanations: {
                    q1: {
                        correct: "O losango representa um n√≥ de decis√£o que determina qual caminho seguir.",
                        incorrect: {
                            a: "",
                            b: "Esta √© a defini√ß√£o de n√≥ inicial.",
                            c: "Esta √© a defini√ß√£o de n√≥ final.",
                            d: "Esta √© a defini√ß√£o de atividade."
                        }
                    },
                    q2: {
                        correct: "A barra de sincroniza√ß√£o permite que m√∫ltiplas atividades sejam executadas em paralelo.",
                        incorrect: {
                            a: "Esta √© a defini√ß√£o de n√≥ de decis√£o.",
                            b: "Esta √© a defini√ß√£o de atividade.",
                            c: "",
                            d: "Esta √© a defini√ß√£o de n√≥ inicial."
                        }
                    },
                    q3: {
                        correct: "O n√≥ inicial marca o in√≠cio do fluxo de atividades.",
                        incorrect: {
                            a: "Esta √© a defini√ß√£o de n√≥ final.",
                            b: "",
                            c: "Esta √© a defini√ß√£o de atividade.",
                            d: "Esta √© a defini√ß√£o de n√≥ de decis√£o."
                        }
                    },
                    q4: {
                        correct: "O fragmento 'loop' representa a repeti√ß√£o de atividades at√© que uma condi√ß√£o seja atendida.",
                        incorrect: {
                            a: "Este √© o fragmento 'alt'.",
                            b: "Este √© o fragmento 'opt'.",
                            c: "Este √© o fragmento 'par'.",
                            d: ""
                        }
                    },
                    q5: {
                        correct: "Um diagrama de atividades complexo deve mostrar claramente todos os caminhos poss√≠veis e suas condi√ß√µes.",
                        incorrect: {
                            a: "",
                            b: "Esta √© uma abordagem incorreta para diagramas complexos.",
                            c: "Esta √© uma abordagem incorreta para diagramas complexos.",
                            d: "Esta √© uma abordagem incorreta para diagramas complexos."
                        }
                    }
                }
            },
            "Diagrama de Estados": {
                reading: "<p>O diagrama de estados modela o comportamento de objetos atrav√©s de diferentes estados e transi√ß√µes entre eles.</p>",
                exerciseUrl: "/exercicios/uml-estados.html",
                correctAnswers: {
                    q1: "c",
                    q2: "b",
                    q3: "a",
                    q4: "d",
                    q5: "b"
                },
                explanations: {
                    q1: {
                        correct: "O estado inicial marca o ponto de entrada no diagrama de estados.",
                        incorrect: {
                            a: "Esta √© a defini√ß√£o de estado final.",
                            b: "Esta √© a defini√ß√£o de estado.",
                            c: "",
                            d: "Esta √© a defini√ß√£o de transi√ß√£o."
                        }
                    },
                    q2: {
                        correct: "A transi√ß√£o mostra a mudan√ßa de um estado para outro quando uma condi√ß√£o √© atendida.",
                        incorrect: {
                            a: "Esta √© a defini√ß√£o de estado.",
                            b: "",
                            c: "Esta √© a defini√ß√£o de a√ß√£o.",
                            d: "Esta √© a defini√ß√£o de guarda."
                        }
                    },
                    q3: {
                        correct: "O estado final marca o ponto de sa√≠da do diagrama de estados.",
                        incorrect: {
                            a: "",
                            b: "Esta √© a defini√ß√£o de estado inicial.",
                            c: "Esta √© a defini√ß√£o de estado.",
                            d: "Esta √© a defini√ß√£o de transi√ß√£o."
                        }
                    },
                    q4: {
                        correct: "Um estado composto cont√©m subestados e pode ter comportamentos pr√≥prios al√©m dos subestados.",
                        incorrect: {
                            a: "Esta √© a defini√ß√£o de estado simples.",
                            b: "Esta √© a defini√ß√£o de estado final.",
                            c: "Esta √© a defini√ß√£o de estado inicial.",
                            d: ""
                        }
                    },
                    q5: {
                        correct: "O hist√≥rico permite que um estado composto retorne ao √∫ltimo subestado ativo.",
                        incorrect: {
                            a: "Esta √© a defini√ß√£o de estado composto.",
                            b: "",
                            c: "Esta √© a defini√ß√£o de transi√ß√£o.",
                            d: "Esta √© a defini√ß√£o de guarda."
                        }
                    }
                }
            },
            "Diagrama de Componentes": {
                reading: "<p>O diagrama de componentes mostra a organiza√ß√£o f√≠sica do sistema em componentes reutiliz√°veis e suas depend√™ncias.</p>",
                exerciseUrl: "/exercicios/uml-componentes.html",
                correctAnswers: {
                    q1: "b",
                    q2: "a",
                    q3: "c",
                    q4: "d",
                    q5: "a"
                },
                explanations: {
                    q1: {
                        correct: "Um componente representa uma parte funcional do sistema que pode ser reutilizada.",
                        incorrect: {
                            a: "Esta √© a defini√ß√£o de interface.",
                            b: "",
                            c: "Esta √© a defini√ß√£o de depend√™ncia.",
                            d: "Esta √© a defini√ß√£o de assembly."
                        }
                    },
                    q2: {
                        correct: "A interface define um contrato que especifica quais opera√ß√µes um componente deve implementar.",
                        incorrect: {
                            a: "",
                            b: "Esta √© a defini√ß√£o de componente.",
                            c: "Esta √© a defini√ß√£o de depend√™ncia.",
                            d: "Esta √© a defini√ß√£o de assembly."
                        }
                    },
                    q3: {
                        correct: "A depend√™ncia indica que um componente precisa de outro para funcionar corretamente.",
                        incorrect: {
                            a: "Esta √© a defini√ß√£o de interface.",
                            b: "Esta √© a defini√ß√£o de componente.",
                            c: "",
                            d: "Esta √© a defini√ß√£o de assembly."
                        }
                    },
                    q4: {
                        correct: "Um assembly conecta interfaces fornecidas e requeridas entre componentes.",
                        incorrect: {
                            a: "Esta √© a defini√ß√£o de depend√™ncia.",
                            b: "Esta √© a defini√ß√£o de interface.",
                            c: "Esta √© a defini√ß√£o de componente.",
                            d: ""
                        }
                    },
                    q5: {
                        correct: "A arquitetura de componentes deve priorizar baixo acoplamento e alta coes√£o para facilitar manuten√ß√£o.",
                        incorrect: {
                            a: "",
                            b: "Esta √© uma abordagem incorreta para arquitetura.",
                            c: "Esta √© uma abordagem incorreta para arquitetura.",
                            d: "Esta √© uma abordagem incorreta para arquitetura."
                        }
                    }
                }
            },
            "Estudo de Caso Pr√°tico": {
                reading: "<p>Esta aula integra todos os conceitos UML atrav√©s de um estudo de caso pr√°tico, mostrando como aplicar diferentes diagramas em um projeto real.</p>",
                exerciseUrl: "/exercicios/uml-caso-pratico.html",
                correctAnswers: {
                    q1: "c",
                    q2: "b",
                    q3: "a",
                    q4: "d",
                    q5: "b"
                },
                explanations: {
                    q1: {
                        correct: "A an√°lise de requisitos deve ser o primeiro passo, identificando funcionalidades e restri√ß√µes do sistema.",
                        incorrect: {
                            a: "Esta √© uma etapa posterior no processo.",
                            b: "Esta √© uma etapa posterior no processo.",
                            c: "",
                            d: "Esta √© uma etapa posterior no processo."
                        }
                    },
                    q2: {
                        correct: "Os diagramas estruturais mostram a organiza√ß√£o est√°tica, enquanto os comportamentais mostram a din√¢mica.",
                        incorrect: {
                            a: "Esta √© uma distin√ß√£o incorreta entre os tipos de diagramas.",
                            b: "",
                            c: "Esta √© uma distin√ß√£o incorreta entre os tipos de diagramas.",
                            d: "Esta √© uma distin√ß√£o incorreta entre os tipos de diagramas."
                        }
                    },
                    q3: {
                        correct: "A consist√™ncia entre diagramas √© fundamental para garantir que o modelo represente corretamente o sistema.",
                        incorrect: {
                            a: "",
                            b: "Esta √© uma abordagem incorreta para modelagem.",
                            c: "Esta √© uma abordagem incorreta para modelagem.",
                            d: "Esta √© uma abordagem incorreta para modelagem."
                        }
                    },
                    q4: {
                        correct: "A valida√ß√£o com stakeholders garante que o modelo atenda √†s expectativas e requisitos do projeto.",
                        incorrect: {
                            a: "Esta √© uma abordagem incompleta para valida√ß√£o.",
                            b: "Esta √© uma abordagem incompleta para valida√ß√£o.",
                            c: "Esta √© uma abordagem incompleta para valida√ß√£o.",
                            d: ""
                        }
                    },
                    q5: {
                        correct: "A refatora√ß√£o cont√≠nua mant√©m o modelo atualizado e alinhado com as mudan√ßas nos requisitos.",
                        incorrect: {
                            a: "Esta √© uma abordagem incorreta para manuten√ß√£o.",
                            b: "",
                            c: "Esta √© uma abordagem incorreta para manuten√ß√£o.",
                            d: "Esta √© uma abordagem incorreta para manuten√ß√£o."
                        }
                    }
                }
            }
        };

        // Estado do usu√°rio (ser√° resetado ao dar refresh)
        let userProgress = {};
        let currentYouTubePlayer = null;
        let videoProgressInterval = null;
        let currentLessonTitle = "";

        // --- FUN√á√ïES ---

        // Fun√ß√£o para rolar suavemente para um elemento com offset
        function smoothScrollToElement(element, offset = 80) {
            const elementPosition = element.getBoundingClientRect().top;
            const offsetPosition = elementPosition + window.pageYOffset - offset;

            window.scrollTo({
                top: offsetPosition,
                behavior: 'smooth'
            });
        }

        // Carrega o conte√∫do de uma aula espec√≠fica
        function loadLesson(lessonLink) {
            console.log('üé¨ loadLesson chamada com:', lessonLink);
            
            // Desativa a aula anterior
            lessonLinks.forEach(link => {
                link.classList.remove('active');
                const icon = link.querySelector('.lesson-icon');
                if (icon && icon.classList.contains('play')) {
                    icon.classList.remove('play');
                    if (!icon.classList.contains('completed')) icon.classList.add('todo');
                }
            });

            // Ativa a nova aula
            lessonLink.classList.add('active');
            
            // Encontra o √≠cone da aula (pode ser .lesson-icon ou SVG)
            let activeIcon = lessonLink.querySelector('.lesson-icon');
            if (!activeIcon) {
                // Se n√£o tem .lesson-icon, cria um
                activeIcon = document.createElement('span');
                activeIcon.className = 'lesson-icon play';
                lessonLink.insertBefore(activeIcon, lessonLink.firstChild);
            } else if (!activeIcon.classList.contains('completed')) {
                activeIcon.classList.remove('todo');
                activeIcon.classList.add('play');
            }
            
            // Carrega o v√≠deo e o texto
            const videoId = lessonLink.getAttribute('data-video-id');
            console.log('üé• Video ID:', videoId);
            
            // Corrige sele√ß√£o do t√≠tulo da aula (pega o segundo span, n√£o o √≠cone nem a dura√ß√£o)
            const allSpans = lessonLink.querySelectorAll('span');
            let titleSpan = null;
            for (let span of allSpans) {
                if (!span.classList.contains('lesson-duration') && !span.classList.contains('lesson-icon')) {
                    titleSpan = span;
                    break;
                }
            }
            currentLessonTitle = titleSpan ? titleSpan.textContent : 'Aula sem t√≠tulo';
            console.log('üìù T√≠tulo da aula:', currentLessonTitle);
            
            videoWrapper.innerHTML = `<div id="youtube-player"></div>`;
            
            lessonTitleHeader.textContent = currentLessonTitle;
            readingTitle.textContent = currentLessonTitle;
            
            // Carrega material de leitura espec√≠fico da aula
            const lessonInfo = lessonData[currentLessonTitle] || {};
            readingText.innerHTML = lessonInfo.reading || "<p>Nenhum material de leitura dispon√≠vel para esta aula.</p>";

            // Inicializa o player do YouTube
            initializeYouTubePlayer(videoId, currentLessonTitle);

            // Atualiza estado dos bot√µes
            updateButtonStates(currentLessonTitle, activeIcon);

            // Reinicia o formul√°rio de exerc√≠cios
            resetExerciseForm();

            // Esconde se√ß√£o de exerc√≠cios inicialmente
            exerciseSection.style.display = 'none';

            // Rola para o topo da p√°gina suavemente
            setTimeout(() => {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            }, 300);
        }

        // Inicializa o player do YouTube com API
        function initializeYouTubePlayer(videoId, lessonTitle) {
            // Para qualquer intervalo de progresso anterior
            if (videoProgressInterval) {
                clearInterval(videoProgressInterval);
                videoProgressInterval = null;
            }

            if (window.YT && window.YT.Player) {
                createYouTubePlayer(videoId, lessonTitle);
            } else {
                // Carrega a API do YouTube se n√£o estiver carregada
                const tag = document.createElement('script');
                tag.src = "https://www.youtube.com/iframe_api";
                const firstScriptTag = document.getElementsByTagName('script')[0];
                firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
                
                window.onYouTubeIframeAPIReady = function() {
                    createYouTubePlayer(videoId, lessonTitle);
                };
            }
        }

        function createYouTubePlayer(videoId, lessonTitle) {
            if (currentYouTubePlayer) {
                currentYouTubePlayer.destroy();
            }

            currentYouTubePlayer = new YT.Player('youtube-player', {
                height: '100%',
                width: '100%',
                videoId: videoId,
                playerVars: {
                    'autoplay': 1,
                    'rel': 0,
                    'modestbranding': 1,
                    'enablejsapi': 1
                },
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange,
                    'onError': onPlayerError
                }
            });

            function onPlayerReady(event) {
                console.log('Player pronto para:', lessonTitle);
            }

            function onPlayerStateChange(event) {
                // Inicia verifica√ß√£o de progresso quando o v√≠deo come√ßa a tocar
                if (event.data === YT.PlayerState.PLAYING) {
                    startVideoProgressCheck(lessonTitle);
                } else if (event.data === YT.PlayerState.PAUSED || event.data === YT.PlayerState.ENDED) {
                    // Para a verifica√ß√£o quando pausa ou termina
                    if (videoProgressInterval) {
                        clearInterval(videoProgressInterval);
                        videoProgressInterval = null;
                    }
                    
                    // Verifica se chegou ao final quando termina
                    if (event.data === YT.PlayerState.ENDED) {
                        handleVideoCompleted(lessonTitle);
                    }
                }
            }

            function onPlayerError(event) {
                console.error('Erro no player YouTube:', event.data);
            }
        }

        // Inicia a verifica√ß√£o de progresso do v√≠deo
        function startVideoProgressCheck(lessonTitle) {
            if (videoProgressInterval) {
                clearInterval(videoProgressInterval);
            }

            videoProgressInterval = setInterval(() => {
                if (currentYouTubePlayer && currentYouTubePlayer.getCurrentTime && currentYouTubePlayer.getDuration) {
                    const currentTime = currentYouTubePlayer.getCurrentTime();
                    const duration = currentYouTubePlayer.getDuration();
                    
                    if (duration > 0) {
                        const progress = (currentTime / duration) * 100;
                        
                        // Salva progresso atual (em mem√≥ria apenas)
                        if (!userProgress[lessonTitle]) {
                            userProgress[lessonTitle] = {};
                        }
                        userProgress[lessonTitle].videoProgress = progress;
                        
                        // Mostra bot√£o de exerc√≠cio se atingiu 90% ou mais (para garantir que funciona)
                        if (progress >= 90 && !userProgress[lessonTitle].videoCompleted) {
                            handleVideoCompleted(lessonTitle);
                            clearInterval(videoProgressInterval);
                            videoProgressInterval = null;
                        }
                    }
                }
            }, 1000); // Verifica a cada 1 segundo
        }

        function handleVideoCompleted(lessonTitle) {
            console.log('‚úÖ V√≠deo completado:', lessonTitle);
            
            if (!userProgress[lessonTitle]) {
                userProgress[lessonTitle] = {};
            }
            userProgress[lessonTitle].videoCompleted = true;
            userProgress[lessonTitle].videoProgress = 100;
            
            showExerciseButton();
            
            // Atualiza o √≠cone da aula para mostrar que o v√≠deo foi assistido
            const activeLessonLink = document.querySelector('.lesson-list a.active');
            if (activeLessonLink) {
                const activeIcon = activeLessonLink.querySelector('.lesson-icon');
                if (activeIcon && !activeIcon.classList.contains('completed')) {
                    activeIcon.classList.remove('play');
                    activeIcon.classList.add('video-watched');
                }
            }
        }

        function showExerciseButton() {
            console.log('üéØ Mostrando bot√£o de exerc√≠cio');
            viewExerciseBtn.classList.remove('hidden');
            viewExerciseBtn.classList.add('visible');
            viewExerciseBtn.style.display = 'inline-block';
        }

        function hideExerciseButton() {
            console.log('üö´ Escondendo bot√£o de exerc√≠cio');
            viewExerciseBtn.classList.add('hidden');
            viewExerciseBtn.classList.remove('visible');
            viewExerciseBtn.style.display = 'none';
        }

        function showCompleteButton() {
            completeButton.classList.remove('hidden');
            completeButton.classList.add('visible');
        }

        function hideCompleteButton() {
            completeButton.classList.add('hidden');
            completeButton.classList.remove('visible');
        }

        function showNextLessonButton() {
            nextLessonBtn.classList.remove('hidden');
            nextLessonBtn.classList.add('visible');
        }

        function hideNextLessonButton() {
            nextLessonBtn.classList.add('hidden');
            nextLessonBtn.classList.remove('visible');
        }

        // Atualiza o estado dos bot√µes
        function updateButtonStates(lessonTitle, activeIcon) {
            const progress = userProgress[lessonTitle];
            
            console.log('üîß updateButtonStates - progress:', progress, 'lessonTitle:', lessonTitle);
            
            // Bot√£o "Ver Exerc√≠cio" - aparece apenas se o v√≠deo foi assistido at√© o fim
            if (progress && progress.videoCompleted && !progress.completed) {
                showExerciseButton();
            } else {
                hideExerciseButton();
            }
            
            // Bot√£o "Marcar como conclu√≠do" - aparece apenas se o exerc√≠cio foi completado
            if (progress && progress.exerciseCompleted && !progress.completed) {
                showCompleteButton();
            } else {
                hideCompleteButton();
            }
            
            // Bot√£o "Pr√≥xima aula" - aparece apenas se a aula foi conclu√≠da
            if (progress && progress.completed) {
                showNextLessonButton();
            } else {
                hideNextLessonButton();
            }

            // Aula j√° conclu√≠da - estado final
            if (progress && progress.completed) {
                viewExerciseBtn.classList.remove('hidden', 'visible');
                viewExerciseBtn.classList.add('completed');
                viewExerciseBtn.textContent = '‚úÖ Exerc√≠cio Conclu√≠do';
                completeButton.classList.add('completed', 'disabled');
                completeButton.textContent = '‚úÖ Conclu√≠do';
                completeButton.style.opacity = '1';
                completeButton.style.pointerEvents = 'none';
            }
        }

        // Atualiza o contador de progresso de um t√≥pico
        function updateTopicProgress(accordionElement) {
            // N√£o atualiza t√≥picos bloqueados (locked-topic)
            if (accordionElement.classList.contains('locked-topic')) {
                return;
            }
            
            const progressSpan = accordionElement.querySelector('.topic-progress');
            const lessons = accordionElement.querySelectorAll('.lesson-list li');
            const completedLessons = accordionElement.querySelectorAll('.lesson-icon.completed');
            
            progressSpan.textContent = `${completedLessons.length}/${lessons.length}`;
        }

        // Verifica se pode desbloquear pr√≥xima aula
        function unlockNextLesson(currentLessonTitle) {
            const currentLessonLink = document.querySelector(`.lesson-list a.active`);
            const currentListItem = currentLessonLink.parentElement;
            const nextListItem = currentListItem.nextElementSibling;
            
            if (nextListItem && nextListItem.classList.contains('lesson-locked')) {
                const nextLessonLink = nextListItem.querySelector('a');
                const allSpans = nextLessonLink.querySelectorAll('span');
                let titleSpan = null;
                for (let span of allSpans) {
                    if (!span.classList.contains('lesson-duration') && !span.classList.contains('lesson-icon')) {
                        titleSpan = span;
                        break;
                    }
                }
                const nextLessonTitle = titleSpan ? titleSpan.textContent : 'Aula sem t√≠tulo';
                
                // Desbloqueia pr√≥xima aula se a atual foi conclu√≠da
                if (userProgress[currentLessonTitle] && userProgress[currentLessonTitle].completed) {
                    // Remove classe de bloqueio e adiciona classe de desbloqueio
                    nextListItem.classList.remove('lesson-locked');
                    nextListItem.classList.add('lesson-unlocked');
                    
                    // Remove o √≠cone de cadeado e adiciona √≠cone padr√£o
                    const lockIcon = nextListItem.querySelector('svg');
                    if (lockIcon) {
                        lockIcon.remove();
                    }
                    
                    // Adiciona o √≠cone padr√£o de aula
                    const iconSpan = document.createElement('span');
                    iconSpan.className = 'lesson-icon todo';
                    nextLessonLink.insertBefore(iconSpan, nextLessonLink.firstChild);
                }
            }
        }

        // Reseta o formul√°rio de exerc√≠cios
        function resetExerciseForm() {
            if (exerciseForm) {
                exerciseForm.reset();
                exerciseFeedback.textContent = '';
                exerciseFeedback.className = '';
                exerciseFeedback.innerHTML = '';
                
                // Remove quaisquer estilos aplicados anteriormente
                document.querySelectorAll('.exercise-question').forEach(question => {
                    question.classList.remove('correct', 'incorrect', 'partial-correct');
                });
            }
        }

        // Verifica as respostas do exerc√≠cio
        function checkExerciseAnswers(lessonTitle) {
            const lessonInfo = lessonData[lessonTitle];
            if (!lessonInfo || !lessonInfo.correctAnswers) {
                return { allCorrect: false, score: 0 };
            }
            
            const formData = new FormData(exerciseForm);
            let correctCount = 0;
            const totalQuestions = Object.keys(lessonInfo.correctAnswers).length;
            
            for (const [question, correctAnswer] of Object.entries(lessonInfo.correctAnswers)) {
                const userAnswer = formData.get(question);
                if (userAnswer === correctAnswer) {
                    correctCount++;
                }
            }
            
            return {
                allCorrect: correctCount === totalQuestions,
                score: correctCount,
                total: totalQuestions
            };
        }

        // Gera feedback detalhado para cada quest√£o
        function generateDetailedFeedback(lessonTitle, result) {
            const lessonInfo = lessonData[lessonTitle];
            if (!lessonInfo || !lessonInfo.explanations) {
                return '';
            }
            
            const formData = new FormData(exerciseForm);
            let feedbackHTML = '';
            
            // Feedback geral
            if (result.allCorrect) {
                feedbackHTML += `<div class="feedback-header success">üéâ Parab√©ns! Voc√™ acertou todas as ${result.total} quest√µes!</div>`;
            } else {
                feedbackHTML += `<div class="feedback-header ${result.score > 0 ? 'partial' : 'error'}">`;
                feedbackHTML += `Voc√™ acertou ${result.score} de ${result.total} quest√µes.`;
                if (result.score > 0) {
                    feedbackHTML += ` Continue estudando para acertar todas!`;
                } else {
                    feedbackHTML += ` Revise o conte√∫do e tente novamente!`;
                }
                feedbackHTML += `</div>`;
            }
            
            // Detalhes por quest√£o
            feedbackHTML += `<div class="question-feedback-container">`;
            
            Object.keys(lessonInfo.correctAnswers).forEach((question, index) => {
                const questionNumber = index + 1;
                const userAnswer = formData.get(question);
                const correctAnswer = lessonInfo.correctAnswers[question];
                const isCorrect = userAnswer === correctAnswer;
                const explanations = lessonInfo.explanations[question];
                
                feedbackHTML += `<div class="question-feedback ${isCorrect ? 'correct' : 'incorrect'}">`;
                feedbackHTML += `<div class="question-header">`;
                feedbackHTML += `<span class="question-number">Quest√£o ${questionNumber}</span>`;
                feedbackHTML += `<span class="question-status ${isCorrect ? 'correct' : 'incorrect'}">`;
                feedbackHTML += isCorrect ? '‚úÖ Correta' : '‚ùå Incorreta';
                feedbackHTML += `</span>`;
                feedbackHTML += `</div>`;
                
                if (isCorrect && explanations.correct) {
                    feedbackHTML += `<div class="explanation correct-explanation">`;
                    feedbackHTML += `<strong>Explica√ß√£o:</strong> ${explanations.correct}`;
                    feedbackHTML += `</div>`;
                } else if (!isCorrect && explanations.incorrect && explanations.incorrect[userAnswer]) {
                    feedbackHTML += `<div class="explanation incorrect-explanation">`;
                    feedbackHTML += `<strong>Sua resposta:</strong> ${getAnswerText(question, userAnswer)}<br>`;
                    feedbackHTML += `<strong>Resposta correta:</strong> ${getAnswerText(question, correctAnswer)}<br>`;
                    feedbackHTML += `<strong>Explica√ß√£o:</strong> ${explanations.incorrect[userAnswer]}`;
                    feedbackHTML += `</div>`;
                }
                
                feedbackHTML += `</div>`;
            });
            
            feedbackHTML += `</div>`;
            
            return feedbackHTML;
        }

        // Obt√©m o texto da resposta baseado no valor
        function getAnswerText(question, value) {
            const questionElement = document.querySelector(`input[name="${question}"][value="${value}"]`);
            if (questionElement) {
                return questionElement.parentElement.textContent.trim();
            }
            return '';
        }

        // Mostra a se√ß√£o de exerc√≠cios e rola at√© ela
        function showExerciseSection() {
            exerciseSection.style.display = 'block';
            setTimeout(() => {
                smoothScrollToElement(exerciseSection, 100);
            }, 50);
        }

        // Volta para a se√ß√£o do v√≠deo
        function backToVideoSection() {
            setTimeout(() => {
                smoothScrollToElement(videoWrapper, 80);
            }, 50);
        }

        // --- EVENT LISTENERS ---

        // Carrega a primeira aula ao entrar na p√°gina
        const firstLesson = document.querySelector('.lesson-list a.active');
        if (firstLesson) {
            console.log('üé¨ Carregando primeira aula:', firstLesson);
            loadLesson(firstLesson);
        } else {
            console.error('‚ùå Nenhuma aula ativa encontrada');
        }

        // Adiciona evento de clique para cada link de aula
        lessonLinks.forEach(link => {
            link.addEventListener('click', function(event) {
                event.preventDefault();
                
                // Verifica se a aula est√° bloqueada
                const listItem = this.parentElement;
                if (listItem.classList.contains('lesson-locked')) {
                    alert('Complete a aula anterior para desbloquear esta aula.');
                    return;
                }
                
                loadLesson(this);
            });
        });

        // Bot√£o de completar aula removido - conclus√£o autom√°tica implementada

        // Evento de clique no bot√£o de exerc√≠cio - MOSTRA A SE√á√ÉO DE EXERC√çCIOS
        viewExerciseBtn.addEventListener('click', function(event) {
            event.preventDefault();
            showExerciseSection();
        });

        // Evento de clique no bot√£o de pr√≥xima aula
        nextLessonBtn.addEventListener('click', function(event) {
            event.preventDefault();
            const activeLessonLink = document.querySelector('.lesson-list a.active');
            if (!activeLessonLink) return;
            
            const currentListItem = activeLessonLink.parentElement;
            const nextListItem = currentListItem.nextElementSibling;
            
            if (nextListItem) {
                const nextLessonLink = nextListItem.querySelector('a');
                
                // Verifica se a pr√≥xima aula est√° bloqueada
                if (nextListItem.classList.contains('lesson-locked')) {
                    alert('Complete a aula atual para desbloquear a pr√≥xima.');
                    return;
                }
                
                // Carrega a pr√≥xima aula
                nextLessonLink.click();
                
                // Volta para o topo do v√≠deo
                backToVideoSection();
            } else {
                alert('N√£o h√° mais aulas neste t√≥pico.');
            }
        });

        // Evento de clique no bot√£o de verificar exerc√≠cio
        submitExerciseBtn.addEventListener('click', function() {
            const activeLessonLink = document.querySelector('.lesson-list a.active');
            if (!activeLessonLink) return;
            
            const allSpans = activeLessonLink.querySelectorAll('span');
            let titleSpan = null;
            for (let span of allSpans) {
                if (!span.classList.contains('lesson-duration') && !span.classList.contains('lesson-icon')) {
                    titleSpan = span;
                    break;
                }
            }
            const lessonTitle = titleSpan ? titleSpan.textContent : 'Aula sem t√≠tulo';
            const result = checkExerciseAnswers(lessonTitle);
            
            // Sistema de primeira tentativa - apenas primeira pontua√ß√£o conta para ranking
            if (!userProgress[lessonTitle]) {
                userProgress[lessonTitle] = {};
            }
            
            // Verifica se √© a primeira tentativa
            const isFirstAttempt = !userProgress[lessonTitle].firstAttemptScore;
            if (isFirstAttempt) {
                // Salva apenas a primeira pontua√ß√£o para ranking
                userProgress[lessonTitle].firstAttemptScore = result.score;
                userProgress[lessonTitle].firstAttemptTotal = result.total;
                userProgress[lessonTitle].firstAttemptPercentage = Math.round((result.score / result.total) * 100);
                userProgress[lessonTitle].firstAttemptDate = new Date().toISOString();
            }
            
            // Incrementa contador de tentativas
            userProgress[lessonTitle].totalAttempts = (userProgress[lessonTitle].totalAttempts || 0) + 1;
            
            // Calcula XP baseado na primeira tentativa
            if (isFirstAttempt) {
                const percentage = userProgress[lessonTitle].firstAttemptPercentage;
                let xpGained = 0;
                if (percentage >= 100) xpGained = 100;
                else if (percentage >= 80) xpGained = 75;
                else if (percentage >= 70) xpGained = 50;
                
                // Atualiza XP do usu√°rio
                updateUserXP(xpGained);
            }
            
            // Gera feedback detalhado
            const feedbackHTML = generateDetailedFeedback(lessonTitle, result);
            exerciseFeedback.innerHTML = feedbackHTML;
            exerciseFeedback.className = 'fade-in detailed-feedback';
            
            // Rola automaticamente para o feedback com offset adequado
            setTimeout(() => {
                smoothScrollToElement(exerciseFeedback, 100);
            }, 100);
            
            // Marca exerc√≠cio como completado
            userProgress[lessonTitle].exerciseCompleted = true;
            
            // Verifica se passou (70% ou mais)
            const percentage = Math.round((result.score / result.total) * 100);
            const passed = percentage >= 70;
            
            if (passed) {
                // Auto-conclus√£o da aula
                autoCompleteLesson(lessonTitle);
                
                // Bot√µes para aula conclu√≠da
                const actionButtonsHTML = `
                    <div class="feedback-actions">
                        <button class="button feedback-next-btn success-btn" id="feedback-next-btn">Pr√≥xima Aula</button>
                    </div>
                `;
                exerciseFeedback.insertAdjacentHTML('beforeend', actionButtonsHTML);
            } else {
                // Bot√µes para tentar novamente
                const actionButtonsHTML = `
                    <div class="feedback-actions">
                        <button class="button feedback-try-again-btn" id="try-again-btn">Tentar Novamente</button>
                    </div>
                `;
                exerciseFeedback.insertAdjacentHTML('beforeend', actionButtonsHTML);
            }
            
            // Adiciona eventos aos bot√µes do feedback
            if (passed) {
                document.getElementById('feedback-next-btn').addEventListener('click', function() {
                    nextLessonBtn.click();
                });
            } else {
                document.getElementById('try-again-btn').addEventListener('click', function() {
                    resetExerciseForm();
                    exerciseFeedback.innerHTML = '';
                    
                    // Rola para o topo dos exerc√≠cios
                    setTimeout(() => {
                        smoothScrollToElement(exerciseSection, 100);
                    }, 50);
                    
                    // Foca na primeira quest√£o para facilitar o novo tentativa
                    const firstQuestion = document.querySelector('.exercise-question:first-child input[type="radio"]');
                    if (firstQuestion) {
                        setTimeout(() => {
                            firstQuestion.focus();
                        }, 200);
                    }
                });
            }
        });

        // L√≥gica para o accordion "sanfona"
        accordions.forEach(accordion => {
            accordion.addEventListener('toggle', function() {
                // Se o accordion atual foi aberto, fecha os outros
                if (this.open) {
                    accordions.forEach(otherAccordion => {
                        if (otherAccordion !== this) {
                            otherAccordion.open = false;
                        }
                    });
                }
            });
        });

        // Menu do usu√°rio √© gerenciado pelo dark-mode.js

        // Atualiza display de gamifica√ß√£o no header
        function updateGamificationDisplay() {
            const gamificationElement = document.getElementById('user-gamification');
            if (gamificationElement) {
                const nextLevelXP = getNextLevelXP(userStats.level);
                const currentLevelXP = getCurrentLevelXP(userStats.level);
                const progress = ((userStats.xp - currentLevelXP) / (nextLevelXP - currentLevelXP)) * 100;
                
                gamificationElement.innerHTML = `
                    <div class="gamification-info">
                        <div class="user-level">${userStats.level}</div>
                        <div class="user-xp">
                            <div class="xp-bar">
                                <div class="xp-fill" style="width: ${Math.min(progress, 100)}%"></div>
                            </div>
                            <span class="xp-text">${userStats.xp} XP</span>
                        </div>
                    </div>
                `;
            }
        }

        // Fun√ß√µes auxiliares para c√°lculo de XP
        function getCurrentLevelXP(level) {
            switch(level) {
                case 'Iniciante': return 0;
                case 'Intermedi√°rio': return 500;
                case 'Avan√ßado': return 1000;
                case 'Expert': return 2000;
                default: return 0;
            }
        }

        function getNextLevelXP(level) {
            switch(level) {
                case 'Iniciante': return 500;
                case 'Intermedi√°rio': return 1000;
                case 'Avan√ßado': return 2000;
                case 'Expert': return 10000;
                default: return 500;
            }
        }

        // Inicializa√ß√£o: aulas bloqueadas j√° est√£o marcadas no HTML
        function initializeProgress() {
            // Carrega estat√≠sticas do usu√°rio
            loadUserStats();
            
            // Atualiza contadores de progresso
            accordions.forEach(accordion => {
                updateTopicProgress(accordion);
            });
        }

        initializeProgress();

        // Adiciona CSS para os novos estilos de feedback
        const style = document.createElement('style');
        style.textContent = `
            .lesson-icon.video-watched::before {
                content: "‚úì";
                background-color: #4CAF50;
                color: white;
            }
            
            .detailed-feedback {
                margin-top: 1.5rem;
                padding: 0;
            }
            
            .feedback-header {
                padding: 1rem 1.5rem;
                border-radius: var(--radius);
                font-weight: 600;
                margin-bottom: 1rem;
                text-align: center;
            }
            
            .feedback-header.success {
                background-color: hsl(142 76% 36% / 0.1);
                color: hsl(142 76% 36%);
                border: 1px solid hsl(142 76% 36% / 0.2);
            }
            
            .feedback-header.partial {
                background-color: hsl(45 93% 47% / 0.1);
                color: hsl(45 93% 47%);
                border: 1px solid hsl(45 93% 47% / 0.2);
            }
            
            .feedback-header.error {
                background-color: hsl(0 84% 60% / 0.1);
                color: hsl(0 84% 60%);
                border: 1px solid hsl(0 84% 60% / 0.2);
            }
            
            .question-feedback-container {
                display: flex;
                flex-direction: column;
                gap: 1rem;
            }
            
            .question-feedback {
                padding: 1.25rem;
                border-radius: var(--radius);
                border-left: 4px solid;
            }
            
            .question-feedback.correct {
                background-color: hsl(142 76% 36% / 0.05);
                border-left-color: hsl(142 76% 36%);
            }
            
            .question-feedback.incorrect {
                background-color: hsl(0 84% 60% / 0.05);
                border-left-color: hsl(0 84% 60%);
            }
            
            .question-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 0.75rem;
            }
            
            .question-number {
                font-weight: 600;
                color: var(--foreground);
            }
            
            .question-status {
                font-weight: 500;
                font-size: 0.9rem;
            }
            
            .question-status.correct {
                color: hsl(142 76% 36%);
            }
            
            .question-status.incorrect {
                color: hsl(0 84% 60%);
            }
            
            .explanation {
                font-size: 0.9rem;
                line-height: 1.5;
                color: var(--muted-foreground);
            }
            
            .correct-explanation {
                color: hsl(142 76% 36%);
            }
            
            .incorrect-explanation {
                color: hsl(0 84% 60%);
            }
            
            .feedback-actions {
                margin-top: 1.5rem;
                display: flex;
                gap: 1rem;
                justify-content: center;
                padding-top: 1rem;
                border-top: 1px solid var(--border);
                flex-wrap: wrap;
            }
            
            .feedback-actions .button {
                margin: 0;
                flex: 1;
                min-width: 150px;
                text-align: center;
                background-color: #3C83F6;
                color: white;
                border: none;
                border-radius: var(--radius);
                padding: 0.75rem 1.5rem;
                font-weight: 500;
                cursor: pointer;
                transition: opacity 0.2s;
            }
            
            .feedback-actions .button:hover {
                opacity: 0.9;
            }
            
            .feedback-actions .button:active {
                opacity: 0.8;
            }
            
            .feedback-complete-btn {
                background-color: #3C83F6 !important;
            }
            
            .feedback-complete-btn.completed {
                background-color: #4CAF50 !important;
                opacity: 1 !important;
            }
            
            .feedback-try-again-btn {
                background-color: #3C83F6 !important;
            }
            
            .feedback-next-btn {
                background-color: #3C83F6 !important;
            }
            
            .fade-in {
                animation: fadeIn 0.5s;
            }
            
            @keyframes fadeIn {
                from { opacity: 0; transform: translateY(-10px); }
                to { opacity: 1; transform: translateY(0); }
            }
        `;
        document.head.appendChild(style);
    });
</script>

<!-- INCLUIR O dark-mode.js ANTES do script personalizado (removido duplicado) -->
</body>
</html>